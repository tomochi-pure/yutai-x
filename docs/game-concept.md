# 株主優待クロスゲーム 修正版完全仕様書

## 🔧 開発方針・制約事項
- **開発者スキル**: コーディング初心者（HTML/CSS/JS基礎知識のみ、コピペレベル）
- **進行方式**: 小さなステップを積み重ねて段階的に実装
- **役割分担**: 要件・指示→開発者、コード作成・技術実装→AI
- **技術選択**: 単一HTML + CSS表示切り替え（初心者に最適）
- **命名規則**: 大文字英語禁止（例：development-status.md）
- **ファイル配置**: ドキュメントはdocs/ディレクトリ
- **β版画面構成**: タイトル画面 → メインゲーム画面（CSS切り替え）
- **認証**: β版はローカルストレージ、将来Firebase実装予定

## 🎮 基本コンセプト
- **ゲーム名**：優待クロスは、やらない方がいい
- **ジャンル**：放置系クリッカーゲーム + 資金管理
- **ターゲット**：Twitter優待クロス界隈（約100名）+ 一般ユーザー
- **プレイ時間**：1回1分程度 × 1日複数回ログイン
- **ゲーム目標**：自己資金を増やして億万長者を目指す
- **対応端末**：スマホ専用（PCでも動作可能だが保証・想定外）

## 🎯 ゲーム概要
証券アプリ風UIで「注文内容を確認」ボタンを連打し、確保した在庫を獲得。獲得した在庫をガチャ装填→発火して優待券をゲット、売却して自己資金を増やしていく放置系ゲーム。基本はbot君による自動化で、プレイヤーは進捗確認とアップグレードがメイン。

## 📱 画面構成（β版）
### タイトル画面
- ゲームタイトル表示
- ユーザー名入力（初回訪問時）
- ログインボタン（メインゲームへ遷移）
- ログインボーナス: 資金20万円/日（0時リセット）

### メインゲーム画面（仕様書の既存内容）
- 5タブ構成のゲーム画面
- クリッカー + 資金管理システム

## 💰 資金・リスク管理システム

### 基本資産構造
- **保有資産（現金）**：1,000万円（初期値）
- **新規建可能額**：保有資産の300% = 3,000万円
- **在庫価値**：30万円固定（β版）
- **保有上限計算**：新規建可能額 ÷ 30万円

### 横転リスクシステム
**確保率と全ロストリスク**：
- **0-50%**：リスク0%（安全圏）
- **50-100%**：リスク0%（まだ安全）
- **100-150%**：リスク10%（要注意）
- **150-200%**：リスク20%（要注意）
- **200-250%**：リスク40%（高リスク）
- **250-300%**：リスク60%（高リスク）
- **300%**：新規建て不可（上限）

### 戦略的要素
- **最適解**：100%付近での運用（合理的プレイ）
- **ハイリスク**：250-300%での豪運チャレンジ
- **判断要素**：ガチャ装填タイミング、アップグレード投資vs安全確保

## ⚙️ β版実装機能

### 🎮 メイン画面レイアウト
```
    [サーバーHP（緑→グレー）目盛り付き]
    
    【注文内容を確認】（緑色・メインボタン・中央）
    
[新規建て可能額（3層重ね合わせバー）] [現引き]（黄色・右上）

自己資金：10,000,000円
新規建て可能額：30,000,000円
50件注文中：15,000,000円（150%/300%）
```

### 📊 3層重ね合わせHPバー仕様
**基盤**：水色背景バー（常時表示）
**層1（0-100%）**：白オーバーレイバー
**層2（100-200%）**：銀オーバーレイバー  
**層3（200-300%）**：虹オーバーレイバー

**目盛り**：25%ごと（0%, 25%, 50%, 75%, 100%）

**視覚例**：
- **50%時点**：水色背景 + 白バー50%
- **150%時点**：水色背景 + 白バー100% + 銀バー50%
- **250%時点**：水色背景 + 白バー100% + 銀バー100% + 虹バー50%

### 🔘 ボタンシステム詳細

**注文内容を確認ボタン（緑色・メイン）**：
- ユーザー・bot君が連打するメインボタン
- 効果：サーバーダメージ確定 + 低確率で在庫獲得
- 位置：画面中央

**現引きボタン（黄色→赤色変化）**：
- 位置：新規建て可能額バー右上
- 初期状態：「現引き」（黄色）
- ガチャ装填：白/銀/虹バーが金色に変化、ボタンが「現渡し」（赤色）に変更
- ガチャ発火：「現渡し」押下で金色バー消失、水色に復帰

### アイテムシステム（3種類）

**💰 通貨系アイテム（資産並列管理）**：
- **お米**：kg単位、資産10,000,000円と同等価値で管理
- **プレミアムコイン**：枚数単位、資産10,000,000円と同等価値で管理

**🎫 優待券カテゴリ**：
- **QUOカード**：6種類の額面 × 枚数管理
  - **S**：10,000円（最高レア）
  - **A**：5,000円（高レア）  
  - **B**：3,000円（中レア）
  - **B**：2,000円（中レア）
  - **C**：1,000円（低レア）
  - **C**：500円（低レア）

### ガチャシステム詳細

**ガチャ装填（現引きフェーズ）**：
- 保有在庫をガチャに装填
- bot君自動クリック停止
- 手動クリック受付停止
- HPバー演出：白/銀/虹→金色変化
- ボタン表記変更：「現引き」（黄色）→「現渡し」（赤色）

**ガチャ発火（現渡しフェーズ）**：
- 装填済みガチャの一括発火
- サーバーHP回復処理
- アイテム抽選・排出
- HPバー復帰：金色→水色ベース
- ボタン表記復帰：「現渡し」→「現引き」
- bot・手動クリック再開
- **ガチャ結果表示のみ**（売却は別タブ）

### 基本システム仕様
- **在庫獲得確率**：10%（基本値）
- **bot君初期性能**：1秒に1回クリック
- **サーバー初期HP**：100,000クリック分
- **サーバーHP回復**：秒間10,000クリック分
- **オフライン計算**：最大10日間

### 放置・自動化機能
- **優待クロスbot君**：自動クリック機能（10段階アップグレード、β版はLv4まで）
- **オフライン進行**：ログアウト中も進行
- **復帰アラート**：「○時間の間に××回クリック」「××個取得」表示

### 特殊システム
- **サーバーダウン**：HP枯渇時の爆発演出、全在庫消失
- **謝罪ボタン**：サーバーダウン時「注文内容を確認」ボタンが「謝罪する」に変更、連打で回復
- **警告書**：サーバーダウン時に配布されるデメリットアイテム（効果未定）

## 🖥️ UI設計

### タブ構成（5タブ想定）
1. **メインタブ**：ゲームプレイ画面
2. **アップグレードタブ**：bot君強化
3. **売却タブ**：獲得アイテム売却
4. **実績タブ**：（完全版実装）
5. **設定タブ**：セーブ・ロード等

### ユーザー体験設計
**1回のセッション（1分程度）**：
1. アプリを開く
2. オフライン進行結果確認
3. 溜まった在庫をガチャ装填→発火
4. ガチャ結果確認
5. 売却タブで優待券売却、資金増加確認
6. bot君アップグレード検討
7. アプリを閉じる

**放置時間の進行レンジ**：
- **序盤**：1-2時間で満タン（頻繁ログイン）
- **中盤**：4-6時間で満タン（1日2-3回）
- **終盤**：8-12時間で満タン（朝晩チェック）

## 🚀 完全版への展望

### 基本拡張機能
- **ストーリー機能**：サーバーダウン後の展開
- **優待券100種類**：「食事優待券」「カフェ優待券」等の多様なアイテム
- **実績システム**：サーバーダウン回数等の記録

### 💾 セーブデータ連携（Firebase）
- **1日1回セーブ**：データの安全性確保
- **ログインボーナス演出**：セーブ確認画面でボーナス受け取り
- **ユーザー体験**：「今日もデータ保存完了！」+ 報酬獲得の一石二鳥

### 🎯 ミッション機能
**基本システム**：
- **実行時間**：2-8時間の多様なミッション
- **複数起動促進**：スタミナ的なユーザー体験
- **アイテム報酬**：多種多様なアイテム配布

**ミッション種類**：
- **自己ミッション**：「8時間労働で20万円」（ゲーム初期の心強い収入源）
- **繰り返しミッション**：日常的な収益システム
- **ストーリーミッション**：一回限り、ストーリー進行必須
- **実績ミッション**：一回限り、特別な解除条件

## 🔧 実装ロードマップ

### 1. 基本UI構築（HTML/CSS）
**目標**：タイトル画面 + メイン画面の基本構造
**完了定義**：
- タイトル画面（ユーザー名入力、ログインボタン）
- メイン画面（5タブレイアウト、基本要素配置）
- 画面切り替え機能（CSS表示制御）
- 3層重ね合わせHPバー実装
- スマホ対応レスポンシブデザイン

**必要な要素**：
```html
<!-- タイトル画面要素 -->
<div id="title-screen">
  <h1>ゲームタイトル</h1>
  <input id="username-input" placeholder="ユーザー名を入力">
  <button id="login-button">ログイン</button>
</div>

<!-- メイン画面要素 -->
<div id="game-screen" style="display: none;">
  <div id="server-hp-bar">サーバーHP表示</div>
  <div id="main-button">注文内容を確認</div>
  <div id="capacity-bar-container">
    <div id="capacity-bar-base">水色背景</div>
    <div id="capacity-bar-white">白オーバーレイ</div>
    <div id="capacity-bar-silver">銀オーバーレイ</div>
    <div id="capacity-bar-rainbow">虹オーバーレイ</div>
  </div>
  <div id="gacha-button">現引き</div>
  <div id="status-display">ステータス表示エリア</div>
  
  <!-- タブナビゲーション -->
  <nav id="tab-navigation">
    <button id="main-tab">メイン</button>
    <button id="upgrade-tab">強化</button>
    <button id="sell-tab">売却</button>
    <!-- 他のタブ -->
  </nav>
</div>
```

### 2. 基本クリックシステム（JavaScript）
**目標**：ボタン押下・カウンター機能の実装
**完了定義**：
- 画面切り替え処理（タイトル→メイン）
- ユーザー名保存・読み込み（ローカルストレージ）
- ログインボーナス判定・付与
- 「注文内容を確認」ボタンクリックでクリック数増加
- サーバーHP減少処理
- 基本的な数値表示更新


### 3. 在庫獲得システム（JavaScript）
**目標**：確率判定・ストック管理の実装
**完了定義**：
- 10%確率で在庫獲得
- 在庫配列への追加
- 上限管理（新規建可能額計算）
- 3層バー表示更新

**追加変数**：
```javascript
// 在庫管理
let zaikoStock = {
  current: 0,               // 現在保有数
  maxCapacity: 0,           // 最大保有可能数（計算値）
  acquisitionRate: 0.1      // 獲得確率（10%）
};

// 資金管理
let assetManager = {
  cash: 10000000,           // 現金
  newOrderLimit: 30000000,  // 新規建可能額（300%）
  riskRatio: 0              // 確保率
};
```

### 4. 3層重ね合わせバーシステム（CSS/JavaScript）
**目標**：視覚的圧迫感の演出実装
**完了定義**：
- 水色背景＋白/銀/虹オーバーレイ
- 25%刻み目盛り表示
- リアルタイム進捗更新
- ガチャ装填時の金色変化

**CSS実装**：
```css
.capacity-bar-container {
  position: relative;
  width: 100%;
  height: 30px;
  background: var(--capacity-base);
}

.capacity-overlay {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  transition: width 0.3s ease;
}

.overlay-white { background: var(--overlay-white); }
.overlay-silver { background: var(--overlay-silver); }
.overlay-rainbow { background: var(--overlay-rainbow); }
.overlay-gold { background: gold; }
```

### 5. ガチャシステム（JavaScript）
**目標**：装填・発火・アイテム排出システム
**完了定義**：
- ボタン状態変更（現引き⇔現渡し）
- 在庫装填でbot停止
- バー金色変化演出
- アイテム抽選・排出
- 状態復帰処理

### 6. 資金・横転リスク管理（JavaScript）
**目標**：新規建可能額計算・全ロスト判定
**完了定義**：
- リアルタイム確保率計算
- 25%/50%刻み閾値別リスク判定
- 全ロスト処理実行

### 7. bot君システム（JavaScript）
**目標**：自動クリック・アップグレード機能
**完了定義**：
- 秒間自動「注文内容を確認」クリック実行
- アップグレード購入機能
- Lv4までの制限実装

### 8. サーバーHP管理（JavaScript）
**目標**：HP減少・回復・ダウン判定システム
**完了定義**：
- クリック時HP減少
- 自動HP回復
- サーバーダウン演出・謝罪システム

### 9. オフライン進行（JavaScript）
**目標**：時間計算・復帰処理システム
**完了定義**：
- オフライン時間計算
- 簡易進行シミュレーション
- 復帰時結果表示

### 10. ローカルストレージ（JavaScript）
**目標**：セーブ・ロード機能実装
**完了定義**：
- 全ゲーム状態の保存
- 起動時自動読み込み
- エラーハンドリング

### 11. UI調整・演出（CSS/JavaScript）
**目標**：アニメーション・エフェクトの実装
**完了定義**：
- ガチャ装填時の金色変化アニメーション
- サーバーダウン爆発エフェクト
- 数値変化アニメーション
- タッチフィードバック

## 🎨 UI・演出方針
- **証券アプリ風デザイン**：リアルな証券会社アプリに似せたUI
- **段階的気づき設計**：「あれ？HP減ってる？」→「楽しい！」→「倒せそう？」→「サーバーダウン」
- **圧迫感演出**：3層重ね合わせバーで3倍レバレッジの危険性を視覚化
- **爽快感演出**：ガチャ装填時の静止→発火、色変化アニメーション
- **界隈ネタ散りばめ**：Twitter優待クロス界隈のインサイダーネタ

## 💾 技術仕様
- **保存方式**：ローカルストレージ（β版）
- **対応環境**：スマートフォンブラウザ
- **外部ライブラリ**：なし（HTML5/CSS3/JavaScript標準のみ）
- **ファイル構成**：
  ```
  優待クロス-シミュレーター/
  ├── 📄 README.md
  ├── 📄 index.html
  ├── 📁 css/
  │   ├── 📄 style.css
  │   └── 📄 animations.css
  ├── 📁 js/
  │   └── 📄 main.js
  ├── 📁 docs/
  │   └── 📄 game-concept.md
  └── 📁 beta/
  ```

## 🏷️ 用語統一
- **確保した在庫**：プレイヤー向け表示名
- **zaiko**：開発時変数名
- **注文内容を確認**：メインクリックボタン名
- **現引き**：ガチャ装填ボタン名
- **現渡し**：ガチャ発火ボタン名

---
**開発方針**：まずは動くものを作る → バランス調整 → 演出強化 → β版リリース → フィードバック収集 → 完全版開発
